<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Fracciones Equivalentes</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #5921f3;
      color: black;
      text-align: center;
      overflow-x: hidden;
      margin: 0;
      padding: 20px;
    }

    .table-container {
      position: relative;
      display: flex;
      justify-content: center;
      gap: 200px;
      margin-top: 30px;
    }

    table {
      border-collapse: collapse;
    }

    th {
      display: none;
    }

    td {
      width: 100px;
      height: 80px;
      background-color: #eae84f;
      border: 2px solid #ccc;
      border-radius: 10px;
      font-size: 24px;
      text-align: center;
      vertical-align: middle;
      cursor: pointer;
      user-select: none;
      position: relative;
    }

    td.selected {
      border: 3px solid yellow;
    }

    .color1 { background-color: #4caf50 !important; } /* Verde */
    .color2 { background-color: #f44336 !important; } /* Rojo */
    .color3 { background-color: #ffeb3b !important; } /* Amarillo */
    .color4 { background-color: #2196f3 !important; } /* Azul */

    #verify {
      margin-top: 30px;
      padding: 10px 20px;
      background-color: #0989a8;
      color: white;
      font-size: 18px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    #mensaje {
      margin-top: 20px;
      font-size: 22px;
      font-weight: bold;
    }

    svg {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 0;
    }
  </style>
</head>
<body>

  <div class="table-container">
    <svg id="lines"></svg>

    <table id="colA">
      <tr><th>Columna A</th></tr>
      <tr><td id="A1">18/30</td></tr>
      <tr><td id="A2">3/5</td></tr>
      <tr><td id="A3">6/8</td></tr>
      <tr><td id="A4">1/2</td></tr>
    </table>

    <table id="colB">
      <tr><th>Columna B</th></tr>
      <tr><td id="B1">5/10</td></tr>
      <tr><td id="B2">3/4</td></tr>
      <tr><td id="B3">6/10</td></tr>
      <tr><td id="B4">9/15</td></tr>
    </table>
  </div>

  <button id="verify" onclick="verificarRespuesta()">Verificar</button>
  <div id="mensaje"></div>

  <script>
    let seleccionA = null;
    let colorIndex = 0;
    const colores = ["color1", "color2", "color3", "color4"];
    const colorHex = {
      color1: "#4caf50",  // verde
      color2: "#f44336",  // rojo
      color3: "#ffeb3b",  // amarillo
      color4: "#2196f3"   // azul
    };
    const emparejamientos = {};
    const svg = document.getElementById("lines");

    const celdasA = document.querySelectorAll("#colA td");
    const celdasB = document.querySelectorAll("#colB td");

    function limpiarSeleccion() {
      celdasA.forEach(c => c.classList.remove("selected"));
      celdasB.forEach(c => c.classList.remove("selected"));
    }

    function dibujarLinea(aId, bId, color) {
      const a = document.getElementById(aId);
      const b = document.getElementById(bId);
      const svgRect = svg.getBoundingClientRect();
      const rectA = a.getBoundingClientRect();
      const rectB = b.getBoundingClientRect();

      const x1 = rectA.right - svgRect.left;
      const y1 = rectA.top + rectA.height / 2 - svgRect.top;
      const x2 = rectB.left - svgRect.left;
      const y2 = rectB.top + rectB.height / 2 - svgRect.top;

      const linea = document.createElementNS("http://www.w3.org/2000/svg", "line");
      linea.setAttribute("x1", x1);
      linea.setAttribute("y1", y1);
      linea.setAttribute("x2", x2);
      linea.setAttribute("y2", y2);
      linea.setAttribute("stroke", color);
      linea.setAttribute("stroke-width", "3");
      linea.setAttribute("data-a", aId);
      linea.setAttribute("data-b", bId);
      svg.appendChild(linea);
    }

    function borrarLinea(aId, bId) {
      const lineas = svg.querySelectorAll("line");
      lineas.forEach(l => {
        if (l.getAttribute("data-a") === aId && l.getAttribute("data-b") === bId) {
          l.remove();
        }
      });
    }

    celdasA.forEach(celda => {
      celda.addEventListener("click", () => {
        limpiarSeleccion();
        celda.classList.add("selected");
        seleccionA = celda;
      });

      celda.addEventListener("dblclick", () => {
        const color = Array.from(celda.classList).find(c => c.startsWith("color"));
        if (color) celda.classList.remove(color);

        for (const b in emparejamientos) {
          if (emparejamientos[b].a === celda.id) {
            document.getElementById(b).classList.remove(color);
            borrarLinea(celda.id, b);
            delete emparejamientos[b];
          }
        }
      });
    });

    celdasB.forEach(celda => {
      celda.addEventListener("click", () => {
        if (seleccionA) {
          const color = colores[colorIndex % colores.length];
          seleccionA.classList.add(color);
          celda.classList.add(color);
          emparejamientos[celda.id] = { a: seleccionA.id, color };
          dibujarLinea(seleccionA.id, celda.id, colorHex[color]);
          colorIndex++;
          seleccionA = null;
          limpiarSeleccion();
        }
      });

      celda.addEventListener("dblclick", () => {
        const color = Array.from(celda.classList).find(c => c.startsWith("color"));
        if (color) celda.classList.remove(color);

        const emp = emparejamientos[celda.id];
        if (emp) {
          document.getElementById(emp.a).classList.remove(color);
          borrarLinea(emp.a, celda.id);
          delete emparejamientos[celda.id];
        }
      });
    });

    function verificarRespuesta() {
      const correctos = {
        B4: "A1",
        B3: "A2",
        B2: "A3",
        B1: "A4"
      };

      let todoBien = true;
      for (const [b, a] of Object.entries(correctos)) {
        if (!emparejamientos[b] || emparejamientos[b].a !== a) {
          todoBien = false;
          break;
        }
      }

      const mensaje = document.getElementById("mensaje");
      if (todoBien && Object.keys(emparejamientos).length === 4) {
        mensaje.innerText = "Â¡Correcto!";
        mensaje.style.color = "limegreen";
      } else {
        mensaje.innerText = "Algunas uniones son incorrectas.";
        mensaje.style.color = "red";
      }
    }
  </script>

</body>
</html>
